PREHOOK: query: -- in this table, rows of different lengths(different number of columns) are loaded
CREATE TABLE t1_multi_delimit(colA int,
  colB tinyint,
  colC timestamp,
  colD smallint,
  colE smallint)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ("field.delim"="^,")STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@t1_multi_delimit
POSTHOOK: query: -- in this table, rows of different lengths(different number of columns) are loaded
CREATE TABLE t1_multi_delimit(colA int,
  colB tinyint,
  colC timestamp,
  colD smallint,
  colE smallint)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ("field.delim"="^,")STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@t1_multi_delimit
PREHOOK: query: LOAD DATA LOCAL INPATH "../../data/files/t1_multi_delimit.csv" INTO TABLE t1_multi_delimit
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@t1_multi_delimit
POSTHOOK: query: LOAD DATA LOCAL INPATH "../../data/files/t1_multi_delimit.csv" INTO TABLE t1_multi_delimit
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@t1_multi_delimit
PREHOOK: query: SELECT * FROM t1_multi_delimit
PREHOOK: type: QUERY
PREHOOK: Input: default@t1_multi_delimit
#### A masked pattern was here ####
POSTHOOK: query: SELECT * FROM t1_multi_delimit
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t1_multi_delimit
#### A masked pattern was here ####
1	1	NULL	0	0
2	1	NULL	0	1
3	1	NULL	0	0
4	1	NULL	0	1
5	5	NULL	NULL	NULL
NULL	NULL	NULL	NULL	NULL
7777	NULL	NULL	NULL	NULL
8	8	NULL	8	8
9	9	NULL	9	9
10101010	NULL	NULL	NULL	NULL
PREHOOK: query: -- in this table, rows of different lengths(different number of columns) and it uses csv serde
CREATE TABLE t11_csv_serde(colA int,
  colB tinyint,
  colC timestamp,
  colD smallint,
  colE smallint)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES ("separatorChar" = ",")STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@t11_csv_serde
POSTHOOK: query: -- in this table, rows of different lengths(different number of columns) and it uses csv serde
CREATE TABLE t11_csv_serde(colA int,
  colB tinyint,
  colC timestamp,
  colD smallint,
  colE smallint)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES ("separatorChar" = ",")STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@t11_csv_serde
PREHOOK: query: LOAD DATA LOCAL INPATH "../../data/files/t11_csv_serde.csv" INTO TABLE t11_csv_serde
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@t11_csv_serde
POSTHOOK: query: LOAD DATA LOCAL INPATH "../../data/files/t11_csv_serde.csv" INTO TABLE t11_csv_serde
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@t11_csv_serde
PREHOOK: query: SELECT * FROM t11_csv_serde
PREHOOK: type: QUERY
PREHOOK: Input: default@t11_csv_serde
#### A masked pattern was here ####
POSTHOOK: query: SELECT * FROM t11_csv_serde
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t11_csv_serde
#### A masked pattern was here ####
1	1		0	0
2	1		0	1
3	1		0	0
4	1		0	1
5	5	NULL	NULL	NULL
NULL	NULL	NULL	NULL	NULL
7777	NULL	NULL	NULL	NULL
8	8		8	8
9	9		9	9
10101010	NULL	NULL	NULL	NULL
PREHOOK: query: -- there should not be any difference between MultiDelimitSerDe table and OpenCSVSerde table results

SELECT count(*)<>10
FROM (
SELECT colA, colB, colC, colD, colE FROM t1_multi_delimit
UNION
SELECT cast(colA as int), cast(colB as tinyint), cast(colC as timestamp), cast(colD as smallint), cast(colE as smallint) FROM t11_csv_serde
) a
PREHOOK: type: QUERY
PREHOOK: Input: default@t11_csv_serde
PREHOOK: Input: default@t1_multi_delimit
#### A masked pattern was here ####
POSTHOOK: query: -- there should not be any difference between MultiDelimitSerDe table and OpenCSVSerde table results

SELECT count(*)<>10
FROM (
SELECT colA, colB, colC, colD, colE FROM t1_multi_delimit
UNION
SELECT cast(colA as int), cast(colB as tinyint), cast(colC as timestamp), cast(colD as smallint), cast(colE as smallint) FROM t11_csv_serde
) a
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t11_csv_serde
POSTHOOK: Input: default@t1_multi_delimit
#### A masked pattern was here ####
false
PREHOOK: query: -- in this table, file having extra column is loaded
CREATE TABLE t2_multi_delimit(colA int,
  colB tinyint,
  colC timestamp,
  colD smallint,
  colE smallint)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ("field.delim"="^,")STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@t2_multi_delimit
POSTHOOK: query: -- in this table, file having extra column is loaded
CREATE TABLE t2_multi_delimit(colA int,
  colB tinyint,
  colC timestamp,
  colD smallint,
  colE smallint)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ("field.delim"="^,")STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@t2_multi_delimit
PREHOOK: query: LOAD DATA LOCAL INPATH "../../data/files/t2_multi_delimit.csv" INTO TABLE t2_multi_delimit
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@t2_multi_delimit
POSTHOOK: query: LOAD DATA LOCAL INPATH "../../data/files/t2_multi_delimit.csv" INTO TABLE t2_multi_delimit
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@t2_multi_delimit
PREHOOK: query: SELECT * FROM t2_multi_delimit
PREHOOK: type: QUERY
PREHOOK: Input: default@t2_multi_delimit
#### A masked pattern was here ####
POSTHOOK: query: SELECT * FROM t2_multi_delimit
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t2_multi_delimit
#### A masked pattern was here ####
1	1	NULL	0	0
2	1	NULL	0	1
3	1	NULL	0	0
4	1	NULL	0	1
PREHOOK: query: -- in this table, delimiter of 5 characters is used
CREATE TABLE t3_multi_delimit(colA int,
  colB tinyint,
  colC timestamp,
  colD smallint,
  colE smallint)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ("field.delim"="^^^^^")STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@t3_multi_delimit
POSTHOOK: query: -- in this table, delimiter of 5 characters is used
CREATE TABLE t3_multi_delimit(colA int,
  colB tinyint,
  colC timestamp,
  colD smallint,
  colE smallint)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ("field.delim"="^^^^^")STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@t3_multi_delimit
PREHOOK: query: LOAD DATA LOCAL INPATH "../../data/files/t3_multi_delimit.csv" INTO TABLE t3_multi_delimit
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@t3_multi_delimit
POSTHOOK: query: LOAD DATA LOCAL INPATH "../../data/files/t3_multi_delimit.csv" INTO TABLE t3_multi_delimit
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@t3_multi_delimit
PREHOOK: query: SELECT * FROM t3_multi_delimit
PREHOOK: type: QUERY
PREHOOK: Input: default@t3_multi_delimit
#### A masked pattern was here ####
POSTHOOK: query: SELECT * FROM t3_multi_delimit
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t3_multi_delimit
#### A masked pattern was here ####
1	1	NULL	0	0
2	1	NULL	0	1
3	1	NULL	0	0
4	1	NULL	0	1
5	5	NULL	NULL	NULL
NULL	NULL	NULL	NULL	NULL
7777	NULL	NULL	NULL	NULL
8	8	NULL	8	8
9	9	NULL	9	9
10101010	NULL	NULL	NULL	NULL
PREHOOK: query: DROP TABLE t1_multi_delimit
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@t1_multi_delimit
PREHOOK: Output: default@t1_multi_delimit
POSTHOOK: query: DROP TABLE t1_multi_delimit
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@t1_multi_delimit
POSTHOOK: Output: default@t1_multi_delimit
PREHOOK: query: DROP TABLE t11_csv_serde
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@t11_csv_serde
PREHOOK: Output: default@t11_csv_serde
POSTHOOK: query: DROP TABLE t11_csv_serde
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@t11_csv_serde
POSTHOOK: Output: default@t11_csv_serde
PREHOOK: query: DROP TABLE t2_multi_delimit
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@t2_multi_delimit
PREHOOK: Output: default@t2_multi_delimit
POSTHOOK: query: DROP TABLE t2_multi_delimit
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@t2_multi_delimit
POSTHOOK: Output: default@t2_multi_delimit
PREHOOK: query: DROP TABLE t3_multi_delimit
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@t3_multi_delimit
PREHOOK: Output: default@t3_multi_delimit
POSTHOOK: query: DROP TABLE t3_multi_delimit
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@t3_multi_delimit
POSTHOOK: Output: default@t3_multi_delimit
